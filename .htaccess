# –£–≤—ñ–º–∫–Ω—É—Ç–∏ –º–æ–¥—É–ª—å –ø–µ—Ä–µ–∑–∞–ø–∏—Å—É
RewriteEngine On

# ============================
# üîÅ –†–µ–¥–∏—Ä–µ–∫—Ç www ‚Üí –±–µ–∑ www + HTTPS
# ============================

# 1. –ó–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è —Ü–∏–∫–ª—É –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—å (Redirect Loop Fix)
# –ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ –Ω–µ –Ω–∞–¥—Å–∏–ª–∞—î—Ç—å—Å—è –∑–∞–≥–æ–ª–æ–≤–æ–∫ X-Forwarded-Proto (–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è Cloudflare/Proxy)
# –ê–ë–û —á–∏ –Ω–µ —î –ø–æ—Ç–æ—á–Ω–µ –∑'—î–¥–Ω–∞–Ω–Ω—è HTTPS
RewriteCond %{HTTP:X-Forwarded-Proto} !https [OR]
RewriteCond %{HTTPS} off [OR]
# –ê–ë–û —á–∏ –¥–æ–º–µ–Ω –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ www
RewriteCond %{HTTP_HOST} ^www\. [NC]

# 2. –Ø–∫—â–æ —Ö–æ—á–∞ –± –æ–¥–Ω–∞ —É–º–æ–≤–∞ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è, –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç–∏ –Ω–∞ https://e-polis.net.ua
RewriteRule ^(.*)$ https://e-polis.net.ua/$1 [L,R=301]

# ============================
# ‚ö° –ö–µ—à—É–≤–∞–Ω–Ω—è —Å—Ç–∞—Ç–∏—á–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ (1 —Ä—ñ–∫)
# ============================
<IfModule mod_expires.c>
  ExpiresActive On
  ExpiresDefault "access plus 1 month"

  ExpiresByType image/jpg "access plus 1 year"
  ExpiresByType image/jpeg "access plus 1 year"
  ExpiresByType image/png "access plus 1 year"
  ExpiresByType image/gif "access plus 1 year"
  ExpiresByType image/webp "access plus 1 year"
  ExpiresByType image/avif "access plus 1 year"
  ExpiresByType image/svg+xml "access plus 1 year"

  ExpiresByType text/css "access plus 1 year"
  ExpiresByType text/javascript "access plus 1 year"
  ExpiresByType application/javascript "access plus 1 year"
  ExpiresByType application/x-javascript "access plus 1 year"
  ExpiresByType application/json "access plus 1 month"

  ExpiresByType application/font-woff "access plus 1 year"
  ExpiresByType application/font-woff2 "access plus 1 year"
  ExpiresByType application/vnd.ms-fontobject "access plus 1 year"
  ExpiresByType font/ttf "access plus 1 year"
  ExpiresByType font/otf "access plus 1 year"

  ExpiresByType text/html "access plus 1 day"
</IfModule>

# ============================
# üóúÔ∏è GZIP-–∫–æ–º–ø—Ä–µ—Å—ñ—è
# ============================
<IfModule mod_deflate.c>
  AddOutputFilterByType DEFLATE text/plain
  AddOutputFilterByType DEFLATE text/html
  AddOutputFilterByType DEFLATE text/xml
  AddOutputFilterByType DEFLATE text/css
  AddOutputFilterByType DEFLATE text/javascript
  AddOutputFilterByType DEFLATE application/javascript
  AddOutputFilterByType DEFLATE application/x-javascript
  AddOutputFilterByType DEFLATE application/json
  AddOutputFilterByType DEFLATE application/xml
  AddOutputFilterByType DEFLATE image/svg+xml
  AddOutputFilterByType DEFLATE font/ttf
  AddOutputFilterByType DEFLATE font/otf
  AddOutputFilterByType DEFLATE font/woff
  AddOutputFilterByType DEFLATE font/woff2
</IfModule>

# ============================
# üîí –ë–µ–∑–ø–µ–∫–∞ + –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å
# ============================
<IfModule mod_headers.c>
  Header set X-Content-Type-Options "nosniff"
  Header set X-Frame-Options "SAMEORIGIN"
  Header set X-XSS-Protection "1; mode=block"
  Header set Referrer-Policy "no-referrer-when-downgrade"
  Header set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
  Header unset ETag
</IfModule>

FileETag None

# ============================
# üß± –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º —ñ–∑ –≥–æ–ª–æ–≤–Ω–æ—é —Å—Ç–æ—Ä—ñ–Ω–∫–æ—é
# ============================
DirectoryIndex index.html index.htm
