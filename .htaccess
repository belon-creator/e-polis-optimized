# –£–≤—ñ–º–∫–Ω—É—Ç–∏ Rewrite Engine
RewriteEngine On

# ============================
# üîÅ –†–µ–¥–∏—Ä–µ–∫—Ç www ‚Üí –±–µ–∑ www + HTTPS
# ============================
RewriteCond %{HTTPS} off [OR]
RewriteCond %{HTTP_HOST} ^www\. [NC]
RewriteRule ^ https://e-polis.net.ua%{REQUEST_URI} [L,R=301]

# ============================
# ‚ö° –ö–µ—à—É–≤–∞–Ω–Ω—è —Å—Ç–∞—Ç–∏—á–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ (1 —Ä—ñ–∫)
# ============================
<IfModule mod_expires.c>
  ExpiresActive On
  ExpiresDefault "access plus 1 month"

  ExpiresByType image/jpg "access plus 1 year"
  ExpiresByType image/jpeg "access plus 1 year"
  ExpiresByType image/png "access plus 1 year"
  ExpiresByType image/gif "access plus 1 year"
  ExpiresByType image/webp "access plus 1 year"
  ExpiresByType image/avif "access plus 1 year"
  ExpiresByType image/svg+xml "access plus 1 year"

  ExpiresByType text/css "access plus 1 year"
  ExpiresByType text/javascript "access plus 1 year"
  ExpiresByType application/javascript "access plus 1 year"
  ExpiresByType application/x-javascript "access plus 1 year"
  ExpiresByType application/json "access plus 1 month"

  ExpiresByType application/font-woff "access plus 1 year"
  ExpiresByType application/font-woff2 "access plus 1 year"
  ExpiresByType application/vnd.ms-fontobject "access plus 1 year"
  ExpiresByType font/ttf "access plus 1 year"
  ExpiresByType font/otf "access plus 1 year"

  ExpiresByType text/html "access plus 1 day"
</IfModule>

# ============================
# üóúÔ∏è GZIP-–∫–æ–º–ø—Ä–µ—Å—ñ—è
# ============================
<IfModule mod_deflate.c>
  AddOutputFilterByType DEFLATE text/plain
  AddOutputFilterByType DEFLATE text/html
  AddOutputFilterByType DEFLATE text/xml
  AddOutputFilterByType DEFLATE text/css
  AddOutputFilterByType DEFLATE text/javascript
  AddOutputFilterByType DEFLATE application/javascript
  AddOutputFilterByType DEFLATE application/x-javascript
  AddOutputFilterByType DEFLATE application/json
  AddOutputFilterByType DEFLATE application/xml
  AddOutputFilterByType DEFLATE image/svg+xml
  AddOutputFilterByType DEFLATE font/ttf
  AddOutputFilterByType DEFLATE font/otf
  AddOutputFilterByType DEFLATE font/woff
  AddOutputFilterByType DEFLATE font/woff2
</IfModule>

# ============================
# üîí –ë–µ–∑–ø–µ–∫–∞ + –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å
# ============================
<IfModule mod_headers.c>
  Header set X-Content-Type-Options "nosniff"
  Header set X-Frame-Options "SAMEORIGIN"
  Header set X-XSS-Protection "1; mode=block"
  Header set Referrer-Policy "no-referrer-when-downgrade"
  Header set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
  Header unset ETag
</IfModule>

FileETag None

# ============================
# üß≠ –î–ª—è SPA (React, Vue, Angular)
# ‚Äî —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ, —â–æ–± –ø—Ä–∞—Ü—é–≤–∞–ª–∏ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ –º–∞—Ä—à—Ä—É—Ç–∏
# ============================
# RewriteCond %{REQUEST_FILENAME} !-f
# RewriteCond %{REQUEST_FILENAME} !-d
# RewriteRule ^ index.html [L]